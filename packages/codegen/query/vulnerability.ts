import { gql } from 'graphql-request'

export const GET_ALL_VULNERABILITIES = gql`
  query VulnerabilitiesWithFilter($where: VulnerabilityWhereInput, $orderBy: [VulnerabilityOrder!], $first: Int, $after: Cursor, $last: Int, $before: Cursor) {
    vulnerabilities(where: $where, orderBy: $orderBy, first: $first, after: $after, last: $last, before: $before) {
      totalCount
      edges {
        node {
          blocking
          category
          createdAt
          createdBy
          cveID
          description
          discoveredAt
          displayID
          displayName
          environmentID
          environmentName
          exploitability
          externalID
          externalOwnerID
          externalURI
          id
          impact
          metadata
          open
          priority
          production
          public
          publishedAt
          rawPayload
          remediationSLA
          scopeID
          scopeName
          score
          severity
          source
          sourceUpdatedAt
          status
          summary
          systemOwned
          updatedAt
          updatedBy
          validated
          vector
        }
      }
      pageInfo {
        endCursor
        startCursor
        hasPreviousPage
        hasNextPage
      }
    }
  }
`

export const VULNERABILITY = gql`
  query Vulnerability($vulnerabilityId: ID!) {
    vulnerability(id: $vulnerabilityId) {
      blocking
      category
      createdAt
      createdBy
      cveID
      description
      discoveredAt
      displayID
      displayName
      environmentID
      environmentName
      exploitability
      externalID
      externalOwnerID
      externalURI
      id
      impact
      metadata
      open
      priority
      production
      public
      publishedAt
      rawPayload
      remediationSLA
      scopeID
      scopeName
      score
      severity
      source
      sourceUpdatedAt
      status
      summary
      systemOwned
      updatedAt
      updatedBy
      validated
      vector
    }
  }
`

export const CREATE_VULNERABILITY = gql`
  mutation CreateVulnerability($input: CreateVulnerabilityInput!) {
    createVulnerability(input: $input) {
      vulnerability {
        id
      }
    }
  }
`

export const UPDATE_VULNERABILITY = gql`
  mutation UpdateVulnerability($updateVulnerabilityId: ID!, $input: UpdateVulnerabilityInput!) {
    updateVulnerability(id: $updateVulnerabilityId, input: $input) {
      vulnerability {
        id
      }
    }
  }
`

export const DELETE_VULNERABILITY = gql`
  mutation DeleteVulnerability($deleteVulnerabilityId: ID!) {
    deleteVulnerability(id: $deleteVulnerabilityId) {
      deletedID
    }
  }
`
